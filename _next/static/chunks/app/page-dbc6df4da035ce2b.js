(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{669:(t,e,a)=>{"use strict";a.d(e,{K:()=>s});var r=a(3464),o=a(1890);class s{logError(t,e){var a,r,o,s,i;console.error("[PixeldrainService Error] ".concat(t),{errorType:null==e?void 0:null===(a=e.constructor)||void 0===a?void 0:a.name,message:null==e?void 0:e.message,status:null==e?void 0:null===(r=e.response)||void 0===r?void 0:r.status,data:null==e?void 0:null===(o=e.response)||void 0===o?void 0:o.data,url:null==e?void 0:null===(s=e.config)||void 0===s?void 0:s.url,method:null==e?void 0:null===(i=e.config)||void 0===i?void 0:i.method})}async getListDetails(t){console.log("[Diagn\xf3stico] Tentando carregar \xe1lbum: ".concat(t)),console.log("[Diagn\xf3stico] URL base: ".concat(this.baseUrl));try{var e,a;let o=await r.A.get("".concat(this.baseUrl,"/list/").concat(t),{timeout:this.timeout,headers:{"Cache-Control":"no-cache",Pragma:"no-cache",Expires:"0"}});if(console.log("[Diagn\xf3stico] Resposta do \xe1lbum recebida:",{status:o.status,dataReceived:!!o.data,fileCount:(null===(a=o.data)||void 0===a?void 0:null===(e=a.files)||void 0===e?void 0:e.length)||0}),!o.data||!o.data.files)throw Error("Dados do \xe1lbum inv\xe1lidos ou vazios");let s=o.data.files.map(t=>({id:t.id||"",name:t.name||"Arquivo sem nome",size:t.size||0,mime_type:t.mime_type||"",views:t.views||0,downloads:t.downloads||0,date_upload:t.date_upload||new Date().toISOString(),date_last_view:t.date_last_view||new Date().toISOString(),hash_sha256:t.hash_sha256||"",can_edit:t.can_edit||!1,description:t.description||""}));return{...o.data,files:s,file_count:s.length}}catch(e){if(this.logError("Erro ao buscar detalhes do \xe1lbum",e),r.A.isAxiosError(e)){if(e.response)switch(e.response.status){case 404:throw Error("\xc1lbum ".concat(t," n\xe3o encontrado"));case 403:throw Error("Acesso negado ao \xe1lbum ".concat(t));case 500:throw Error("Erro interno do servidor ao buscar \xe1lbum ".concat(t))}else if(e.request)throw Error("Sem resposta do servidor ao buscar \xe1lbum ".concat(t))}throw Error("Falha ao carregar \xe1lbum ".concat(t,": ").concat(e instanceof Error?e.message:"Erro desconhecido"))}}async getAllAlbums(){try{var t;let e=await r.A.get("".concat(this.baseUrl,"/list"));return(null===(t=e.data)||void 0===t?void 0:t.lists)||[]}catch(t){throw r.A.isAxiosError(t)&&this.handleError(t,"buscar lista de \xe1lbuns"),t}}async checkFileAvailability(t){try{let e=await r.A.head("".concat(this.baseUrl,"/file/").concat(t));return 200===e.status}catch(e){return r.A.isAxiosError(e)&&console.warn("Arquivo ".concat(t," n\xe3o dispon\xedvel"),e.message),!1}}async fetchWithAuth(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=new URL(this.baseUrl);a.searchParams.set("endpoint",t);let r=new Headers(e.headers);r.set("Accept","application/json"),r.set("Content-Type","application/json");let o={...e,headers:r,mode:"cors",credentials:"omit"};try{let t=await fetch(a.toString(),o);if(!t.ok){let e=await t.text();throw console.error("Erro na resposta:",{status:t.status,statusText:t.statusText,data:e}),Error("Erro na API do Pixeldrain: ".concat(t.status," ").concat(t.statusText,"\n").concat(e))}return t.json()}catch(t){throw console.error("Erro na requisi\xe7\xe3o:",t),t}}async getFiles(){try{return(await this.fetchWithAuth("/user/files")).files||[]}catch(t){return console.error("Erro ao buscar arquivos:",t),[]}}async getUserLists(){try{let t=(await this.fetchWithAuth("/user/lists")).lists||[];return await Promise.all(t.map(async t=>{try{let e=await this.getListDetails(t.id);return{...t,file_count:e.files.length}}catch(e){return console.error("Erro ao buscar detalhes do \xe1lbum ".concat(t.id,":"),e),{...t,file_count:0}}}))}catch(t){return console.error("Erro ao buscar \xe1lbuns:",t),[]}}getFileViewUrl(t){return"https://pixeldrain.com/v/".concat(t)}getFileThumbnailUrl(t){return"https://pixeldrain.com/api/file/".concat(t,"/thumbnail")}async createAlbum(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return this.fetchWithAuth("/list",{method:"POST",body:JSON.stringify({title:t,description:e,files:[]})})}async addFileToAlbum(t,e){await this.fetchWithAuth("/list/".concat(t,"/file/").concat(e),{method:"POST"})}async removeFileFromAlbum(t,e){await this.fetchWithAuth("/list/".concat(t,"/file/").concat(e),{method:"DELETE"})}async deleteAlbum(t){await this.fetchWithAuth("/list/".concat(t),{method:"DELETE"})}async checkAlbumAvailability(t){console.log("[Diagn\xf3stico] Verificando disponibilidade do \xe1lbum: ".concat(t));try{let e=await r.A.head("".concat(this.baseUrl,"/list/").concat(t),{timeout:this.timeout,validateStatus:t=>200===t||404===t});return console.log("[Diagn\xf3stico] Status da verifica\xe7\xe3o de disponibilidade:",{status:e.status,headers:e.headers}),200===e.status}catch(t){return this.logError("Erro ao verificar disponibilidade do \xe1lbum",t),!1}}constructor(){this.baseUrl=o.env.NEXT_PUBLIC_PIXELDRAIN_PROXY||"/proxy/pixeldrain",this.timeout=1e4}}},1057:(t,e,a)=>{"use strict";a.r(e),a.d(e,{default:()=>f});var r=a(5155),o=a(2115),s=a(669),i=a(4256),l=a(3088),n=a(9915),c=a(3100),d=a(3339),h=a(5857);let u=(0,a(7833).Ay)(i.A)(t=>{let{theme:e}=t;return{margin:e.spacing(1),width:"100%",maxWidth:600,backgroundColor:"#1a1a1a",color:"#ffffff","& .MuiTypography-root":{color:"#ffffff"},"& .MuiTypography-colorTextSecondary":{color:"#aaaaaa"}}});function f(){let[t,e]=(0,o.useState)([]),[a,i]=(0,o.useState)([]),[f,m]=(0,o.useState)(!1),[v,b]=(0,o.useState)(null),g=new s.K,x=async()=>{m(!0),b(null);try{let t=await g.getFiles();e(t);let a=await g.getUserLists();i(a)}catch(t){console.error("Erro ao carregar conte\xfado:",t),b(t instanceof Error?t.message:"Erro ao carregar conte\xfado")}finally{m(!1)}};return(0,o.useEffect)(()=>{x()},[]),(0,r.jsxs)("main",{className:"flex min-h-screen flex-col items-center p-4",style:{backgroundColor:"#121212",color:"#ffffff"},children:[(0,r.jsx)("h1",{className:"text-4xl font-bold mb-8 text-white",children:"\xcdndice Pixeldrain"}),v&&(0,r.jsx)(l.A,{severity:"error",sx:{width:"100%",maxWidth:600,mb:2,backgroundColor:"#ff000033",color:"#ffffff"},children:v}),f?(0,r.jsx)(n.A,{sx:{color:"#ffffff"}}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("section",{className:"w-full max-w-3xl",children:[(0,r.jsxs)(c.A,{variant:"h5",gutterBottom:!0,sx:{color:"#ffffff"},children:["\xc1lbuns (",a.length,")"]}),a.map(t=>{var e;return(0,r.jsx)(u,{children:(0,r.jsxs)(d.A,{children:[(0,r.jsx)(c.A,{variant:"h6",children:t.title}),(0,r.jsx)(c.A,{variant:"body2",color:"text.secondary",children:t.description}),t.date_created&&(0,r.jsxs)(c.A,{variant:"caption",display:"block",children:["Criado em: ",new Date(t.date_created).toLocaleDateString()]}),(0,r.jsxs)(c.A,{variant:"body2",children:["Arquivos: ",(null===(e=t.files)||void 0===e?void 0:e.length)||0]}),(0,r.jsx)(h.A,{variant:"contained",color:"primary",href:"/album/".concat(t.id),sx:{mt:2},children:"Ver \xc1lbum"})]})},t.id)})]}),(0,r.jsxs)("section",{className:"w-full max-w-3xl mt-8",children:[(0,r.jsxs)(c.A,{variant:"h5",gutterBottom:!0,sx:{color:"#ffffff"},children:["Arquivos (",t.length,")"]}),t.map(t=>(0,r.jsx)(u,{children:(0,r.jsxs)(d.A,{children:[(0,r.jsx)(c.A,{variant:"h6",children:t.name}),(0,r.jsxs)(c.A,{variant:"body2",color:"text.secondary",children:["Tamanho: ",(t.size/1024/1024).toFixed(2)," MB"]}),(0,r.jsxs)(c.A,{variant:"body2",color:"text.secondary",children:["Views: ",t.views]}),t.date_upload&&(0,r.jsxs)(c.A,{variant:"caption",display:"block",children:["Enviado em: ",new Date(t.date_upload).toLocaleDateString()]}),(0,r.jsx)(h.A,{variant:"contained",color:"primary",href:"/file/".concat(t.id),sx:{mt:2},children:"Visualizar"})]})},t.id))]})]})]})}},4906:(t,e,a)=>{Promise.resolve().then(a.bind(a,1057))}},t=>{var e=e=>t(t.s=e);t.O(0,[857,657,441,684,358],()=>e(4906)),_N_E=t.O()}]);