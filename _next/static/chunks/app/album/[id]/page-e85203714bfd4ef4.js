(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[880],{669:(e,t,s)=>{"use strict";s.d(t,{K:()=>a});var i=s(3464),r=s(1890);class a{logError(e,t){var s,i,r,a,o;console.error("[PixeldrainService Error] ".concat(e),{errorType:null==t?void 0:null===(s=t.constructor)||void 0===s?void 0:s.name,message:null==t?void 0:t.message,status:null==t?void 0:null===(i=t.response)||void 0===i?void 0:i.status,data:null==t?void 0:null===(r=t.response)||void 0===r?void 0:r.data,url:null==t?void 0:null===(a=t.config)||void 0===a?void 0:a.url,method:null==t?void 0:null===(o=t.config)||void 0===o?void 0:o.method})}async getListDetails(e){console.log("[Diagn\xf3stico] Tentando carregar \xe1lbum: ".concat(e)),console.log("[Diagn\xf3stico] URL base: ".concat(this.baseUrl));try{var t,s;let r=await i.A.get("".concat(this.baseUrl,"/list/").concat(e),{timeout:this.timeout,headers:{"Cache-Control":"no-cache",Pragma:"no-cache",Expires:"0"}});if(console.log("[Diagn\xf3stico] Resposta do \xe1lbum recebida:",{status:r.status,dataReceived:!!r.data,fileCount:(null===(s=r.data)||void 0===s?void 0:null===(t=s.files)||void 0===t?void 0:t.length)||0}),!r.data||!r.data.files)throw Error("Dados do \xe1lbum inv\xe1lidos ou vazios");let a=r.data.files.map(e=>({id:e.id||"",name:e.name||"Arquivo sem nome",size:e.size||0,mime_type:e.mime_type||"",views:e.views||0,downloads:e.downloads||0,date_upload:e.date_upload||new Date().toISOString(),date_last_view:e.date_last_view||new Date().toISOString(),hash_sha256:e.hash_sha256||"",can_edit:e.can_edit||!1,description:e.description||""}));return{...r.data,files:a,file_count:a.length}}catch(t){if(this.logError("Erro ao buscar detalhes do \xe1lbum",t),i.A.isAxiosError(t)){if(t.response)switch(t.response.status){case 404:throw Error("\xc1lbum ".concat(e," n\xe3o encontrado"));case 403:throw Error("Acesso negado ao \xe1lbum ".concat(e));case 500:throw Error("Erro interno do servidor ao buscar \xe1lbum ".concat(e))}else if(t.request)throw Error("Sem resposta do servidor ao buscar \xe1lbum ".concat(e))}throw Error("Falha ao carregar \xe1lbum ".concat(e,": ").concat(t instanceof Error?t.message:"Erro desconhecido"))}}async getAllAlbums(){try{var e;let t=await i.A.get("".concat(this.baseUrl,"/list"));return(null===(e=t.data)||void 0===e?void 0:e.lists)||[]}catch(e){throw i.A.isAxiosError(e)&&this.handleError(e,"buscar lista de \xe1lbuns"),e}}async checkFileAvailability(e){try{let t=await i.A.head("".concat(this.baseUrl,"/file/").concat(e));return 200===t.status}catch(t){return i.A.isAxiosError(t)&&console.warn("Arquivo ".concat(e," n\xe3o dispon\xedvel"),t.message),!1}}async fetchWithAuth(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=new URL(this.baseUrl);s.searchParams.set("endpoint",e);let i=new Headers(t.headers);i.set("Accept","application/json"),i.set("Content-Type","application/json");let r={...t,headers:i,mode:"cors",credentials:"omit"};try{let e=await fetch(s.toString(),r);if(!e.ok){let t=await e.text();throw console.error("Erro na resposta:",{status:e.status,statusText:e.statusText,data:t}),Error("Erro na API do Pixeldrain: ".concat(e.status," ").concat(e.statusText,"\n").concat(t))}return e.json()}catch(e){throw console.error("Erro na requisi\xe7\xe3o:",e),e}}async getFiles(){try{return(await this.fetchWithAuth("/user/files")).files||[]}catch(e){return console.error("Erro ao buscar arquivos:",e),[]}}async getUserLists(){try{let e=(await this.fetchWithAuth("/user/lists")).lists||[];return await Promise.all(e.map(async e=>{try{let t=await this.getListDetails(e.id);return{...e,file_count:t.files.length}}catch(t){return console.error("Erro ao buscar detalhes do \xe1lbum ".concat(e.id,":"),t),{...e,file_count:0}}}))}catch(e){return console.error("Erro ao buscar \xe1lbuns:",e),[]}}getFileViewUrl(e){return"https://pixeldrain.com/v/".concat(e)}getFileThumbnailUrl(e){return"https://pixeldrain.com/api/file/".concat(e,"/thumbnail")}async createAlbum(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return this.fetchWithAuth("/list",{method:"POST",body:JSON.stringify({title:e,description:t,files:[]})})}async addFileToAlbum(e,t){await this.fetchWithAuth("/list/".concat(e,"/file/").concat(t),{method:"POST"})}async removeFileFromAlbum(e,t){await this.fetchWithAuth("/list/".concat(e,"/file/").concat(t),{method:"DELETE"})}async deleteAlbum(e){await this.fetchWithAuth("/list/".concat(e),{method:"DELETE"})}async checkAlbumAvailability(e){console.log("[Diagn\xf3stico] Verificando disponibilidade do \xe1lbum: ".concat(e));try{let t=await i.A.head("".concat(this.baseUrl,"/list/").concat(e),{timeout:this.timeout,validateStatus:e=>200===e||404===e});return console.log("[Diagn\xf3stico] Status da verifica\xe7\xe3o de disponibilidade:",{status:t.status,headers:t.headers}),200===t.status}catch(e){return this.logError("Erro ao verificar disponibilidade do \xe1lbum",e),!1}}constructor(){this.baseUrl=r.env.NEXT_PUBLIC_PIXELDRAIN_PROXY||"/proxy/pixeldrain",this.timeout=1e4}}},3387:(e,t,s)=>{Promise.resolve().then(s.bind(s,4423))},4423:(e,t,s)=>{"use strict";s.d(t,{default:()=>x});var i=s(5155),r=s(2115),a=s(669);let o=e=>{var t,s,a;let{file:o}=e,[l,n]=(0,r.useState)(!0),[c,d]=(0,r.useState)(null),[u,h]=(0,r.useState)(!1),m=null===(t=o.mime_type)||void 0===t?void 0:t.startsWith("image/"),v=null===(s=o.mime_type)||void 0===s?void 0:s.startsWith("video/"),f=null===(a=o.mime_type)||void 0===a?void 0:a.startsWith("audio/"),p="application/pdf"===o.mime_type,x="https://pixeldrain.com/api/file/".concat(o.id),g="".concat(x,"?download"),b="https://pixeldrain.com/api/file/".concat(o.id,"/thumbnail"),w=(e,t)=>{console.error("[FileViewer Error] ".concat(e),{fileId:o.id,fileName:o.name,mimeType:o.mime_type,errorDetails:t instanceof Error?t.message:t})};return((0,r.useEffect)(()=>{n(!0),d(null),h(!1);let e=setTimeout(()=>{n(!1)},1e3);return()=>clearTimeout(e)},[o.id]),l)?(0,i.jsx)("div",{className:"flex justify-center items-center p-8 bg-gray-100 rounded-lg",children:(0,i.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):c?(0,i.jsxs)("div",{className:"p-4 bg-red-100 text-red-700 rounded-lg",children:[(0,i.jsxs)("p",{children:["Erro ao carregar o arquivo: ",c]}),(0,i.jsx)("button",{className:"mt-2 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",onClick:()=>window.open(g,"_blank"),children:"Tentar Baixar Diretamente"})]}):(0,i.jsxs)("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden",children:[(0,i.jsxs)("div",{className:"p-4 bg-gray-50 border-b",children:[(0,i.jsx)("h2",{className:"text-xl font-bold truncate",children:o.name}),(0,i.jsxs)("div",{className:"flex justify-between text-sm text-gray-500 mt-1",children:[(0,i.jsx)("span",{children:function(e){if(0===e)return"0 Bytes";let t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB","GB","TB"][t]}(o.size)}),(0,i.jsxs)("span",{children:[o.views||0," visualiza\xe7\xf5es"]})]})]}),(0,i.jsxs)("div",{className:"p-4",children:[m&&(0,i.jsx)("div",{className:"aspect-w-16 aspect-h-9 bg-black flex justify-center",children:(0,i.jsx)("img",{src:x,alt:o.name,className:"max-h-[600px] object-contain mx-auto",onError:e=>{w("Erro ao carregar imagem",e),d("N\xe3o foi poss\xedvel carregar a imagem.")}})}),v&&(0,i.jsx)("div",{className:"aspect-w-16 aspect-h-9 bg-black",children:(0,i.jsx)("video",{src:x,controls:!0,autoPlay:!0,className:"w-full h-full",onError:e=>{w("Erro ao reproduzir v\xeddeo",e),d("N\xe3o foi poss\xedvel reproduzir o v\xeddeo.")},children:"Seu navegador n\xe3o suporta a reprodu\xe7\xe3o de v\xeddeos."})}),f&&(0,i.jsx)("div",{className:"p-4 bg-gray-100 rounded-lg",children:(0,i.jsx)("audio",{src:x,controls:!0,className:"w-full",onError:e=>{w("Erro ao reproduzir \xe1udio",e),d("N\xe3o foi poss\xedvel reproduzir o \xe1udio.")},children:"Seu navegador n\xe3o suporta a reprodu\xe7\xe3o de \xe1udios."})}),p&&(0,i.jsx)("div",{className:"aspect-w-16 aspect-h-9 bg-gray-100 flex justify-center items-center",children:(0,i.jsx)("iframe",{src:"".concat(x,"#toolbar=0"),className:"w-full h-[600px]",title:o.name,onError:e=>{w("Erro ao carregar PDF",e),d("N\xe3o foi poss\xedvel carregar o PDF.")}})}),!m&&!v&&!f&&!p&&(0,i.jsxs)("div",{className:"p-8 flex flex-col items-center justify-center bg-gray-100 rounded-lg",children:[(0,i.jsx)("img",{src:(()=>{if(u){var e,t,s,i,r,a,l,n,c,d,h,m;let u={image:"/icons/image.svg",video:"/icons/video.svg",audio:"/icons/audio.svg",pdf:"/icons/pdf.svg",document:"/icons/document.svg",spreadsheet:"/icons/spreadsheet.svg",presentation:"/icons/presentation.svg",archive:"/icons/archive.svg",default:"/icons/file.svg"};return(null===(e=o.mime_type)||void 0===e?void 0:e.startsWith("image/"))?u.image:(null===(t=o.mime_type)||void 0===t?void 0:t.startsWith("video/"))?u.video:(null===(s=o.mime_type)||void 0===s?void 0:s.startsWith("audio/"))?u.audio:"application/pdf"===o.mime_type?u.pdf:(null===(i=o.mime_type)||void 0===i?void 0:i.includes("document"))||(null===(r=o.mime_type)||void 0===r?void 0:r.includes("word"))?u.document:(null===(a=o.mime_type)||void 0===a?void 0:a.includes("spreadsheet"))||(null===(l=o.mime_type)||void 0===l?void 0:l.includes("excel"))?u.spreadsheet:(null===(n=o.mime_type)||void 0===n?void 0:n.includes("presentation"))||(null===(c=o.mime_type)||void 0===c?void 0:c.includes("powerpoint"))?u.presentation:(null===(d=o.mime_type)||void 0===d?void 0:d.includes("archive"))||(null===(h=o.mime_type)||void 0===h?void 0:h.includes("zip"))||(null===(m=o.mime_type)||void 0===m?void 0:m.includes("rar"))?u.archive:u.default}return b})(),alt:"Thumbnail",className:"w-32 h-32 object-contain mb-4",onError:e=>{w("Erro ao carregar thumbnail",e),h(!0)}}),(0,i.jsx)("p",{className:"text-center mb-4",children:"Este tipo de arquivo n\xe3o pode ser visualizado diretamente no navegador."}),(0,i.jsx)("button",{className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",onClick:()=>window.open(g,"_blank"),children:"Baixar Arquivo"})]})]}),(0,i.jsxs)("div",{className:"p-4 bg-gray-50 border-t flex justify-between",children:[(0,i.jsx)("button",{className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",onClick:()=>window.open(g,"_blank"),children:"Baixar"}),(0,i.jsxs)("div",{className:"text-sm text-gray-500",children:["Compartilhar:",(0,i.jsx)("button",{className:"ml-2 text-blue-500 hover:underline",onClick:()=>{navigator.clipboard.writeText("https://pixeldrain.com/u/".concat(o.id)),alert("Link copiado para \xe1rea de transfer\xeancia!")},children:"Copiar Link"})]})]})]})};var l=s(3100),n=s(3951),c=s(4256),d=s(3339);function u(e){if(e.startsWith("image/"))return"/icons/image.svg";if(e.startsWith("video/"))return"/icons/video.svg";if(e.startsWith("audio/"))return"/icons/audio.svg";if("application/pdf"===e)return"/icons/pdf.svg";if(e.includes("document")||e.includes("word"))return"/icons/document.svg";else if(e.includes("spreadsheet")||e.includes("excel"))return"/icons/spreadsheet.svg";else if(e.includes("presentation")||e.includes("powerpoint"))return"/icons/presentation.svg";else if(e.includes("archive")||e.includes("zip")||e.includes("rar"))return"/icons/archive.svg";else return"/icons/file.svg"}let h=e=>{let{album:t,viewMode:s="grid"}=e,[a,h]=(0,r.useState)(0);if(!t.files||0===t.files.length)return(0,i.jsx)("div",{className:"p-4 bg-yellow-100 text-yellow-700 rounded-lg mb-4",children:"Este \xe1lbum est\xe1 vazio."});let m=t.files[a];return(0,i.jsxs)("div",{className:"bg-gray-900 rounded-lg shadow-lg overflow-hidden",children:[(0,i.jsxs)("div",{className:"p-4",children:[m&&(0,i.jsx)("div",{className:"mb-4"}),(0,i.jsx)(o,{file:m})]}),t.files.length>0&&(0,i.jsxs)("div",{className:"p-4 bg-gray-800",children:[(0,i.jsxs)(l.A,{variant:"h6",className:"text-white mb-4",children:["Arquivos no \xc1lbum (",t.files.length,")"]}),(0,i.jsx)(n.Ay,{container:!0,spacing:2,className:"list"===s?"flex-col":"",children:t.files.map((e,t)=>{var r;return(0,i.jsx)(n.Ay,{item:!0,xs:12,sm:"list"===s?12:6,md:"list"===s?12:4,lg:"list"===s?12:3,children:(0,i.jsxs)(c.A,{className:"cursor-pointer transition-all duration-200 ".concat(a===t?"ring-2 ring-blue-500":"hover:ring-2 hover:ring-blue-300"," ").concat("list"===s?"flex items-center":""),onClick:()=>h(t),sx:{backgroundColor:"#1a1a1a",height:"100%",flexDirection:"list"===s?"row":"column"},children:[(0,i.jsx)("div",{className:"relative ".concat("list"===s?"w-32 h-24 mr-4 flex-shrink-0":"aspect-w-16 aspect-h-9"),children:(null===(r=e.mime_type)||void 0===r?void 0:r.startsWith("video/"))?(0,i.jsxs)("div",{className:"w-full h-full bg-black flex items-center justify-center",children:[(0,i.jsx)("img",{src:"https://pixeldrain.com/api/file/".concat(e.id,"/thumbnail"),alt:e.name,className:"w-full h-full object-cover",onError:t=>{t.currentTarget.src=u(e.mime_type||"")}}),(0,i.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,i.jsx)("svg",{className:"w-12 h-12 text-white opacity-80",fill:"currentColor",viewBox:"0 0 20 20",children:(0,i.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z",clipRule:"evenodd"})})})]}):(0,i.jsx)("img",{src:"https://pixeldrain.com/api/file/".concat(e.id,"/thumbnail"),alt:e.name,className:"w-full h-full object-cover",onError:t=>{t.currentTarget.src=u(e.mime_type||"")}})}),(0,i.jsxs)(d.A,{sx:{color:"#fff",flex:1,display:"flex",flexDirection:"column",justifyContent:"center"},children:[(0,i.jsx)(l.A,{variant:"subtitle1",component:"h3",className:"font-medium ".concat("list"===s?"text-base":"truncate"),children:e.name}),(0,i.jsx)(l.A,{variant:"body2",className:"text-gray-400 ".concat("list"===s?"text-sm":""),children:function(e){if(0===e)return"0 Bytes";let t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB","GB","TB"][t]}(e.size)}),(0,i.jsxs)(l.A,{variant:"caption",className:"text-gray-500 ".concat("list"===s?"text-xs":""),children:[e.views," visualiza\xe7\xf5es"]})]})]})},e.id)})})]})]})};var m=s(3088),v=s(5857),f=s(9915),p=s(5695);function x(e){let{params:t}=e,[s,o]=(0,r.useState)(null),[l,n]=(0,r.useState)(!0),[c,d]=(0,r.useState)(null),[u,x]=(0,r.useState)("grid"),[g,b]=(0,r.useState)("asc"),w=(0,p.useRouter)(),j=new a.K;(0,r.useEffect)(()=>{(async()=>{try{var e;let s=null===(e=t.id)||void 0===e?void 0:e.trim();if(!s||""===s||"default-album"===s||"undefined"===s)throw Error('ID de \xe1lbum inv\xe1lido: "'.concat(s,'"'));console.log("Carregando \xe1lbum com ID:",s);let i=await j.getListDetails(s);console.log("Dados do \xe1lbum:",i),o(i)}catch(s){console.error("Erro ao carregar \xe1lbum:",s);let e=s instanceof Error?s.message:"Erro desconhecido ao carregar \xe1lbum";d(e),o({id:t.id||"album-erro",title:"\xc1lbum n\xe3o encontrado",description:e,date_created:new Date().toISOString(),files:[],can_edit:!1,file_count:0})}finally{n(!1)}})()},[t.id]);let y=()=>{w.push("/")},N=(null==s?void 0:s.files)?[...s.files].sort((e,t)=>{let s=e.name.localeCompare(t.name);return"asc"===g?s:-s}):[];return"default-album"===t.id||c?(0,i.jsx)("main",{className:"min-h-screen p-4",style:{backgroundColor:"#121212",color:"#ffffff"},children:(0,i.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,i.jsx)(m.A,{severity:"warning",sx:{mb:2,backgroundColor:"#ffa50033",color:"#ffffff"},children:c||"Este \xe1lbum n\xe3o est\xe1 dispon\xedvel no momento."}),(0,i.jsx)(v.A,{variant:"contained",onClick:y,sx:{backgroundColor:"#333",color:"#fff","&:hover":{backgroundColor:"#444"}},children:"Voltar para o In\xedcio"})]})}):(0,i.jsx)("main",{className:"min-h-screen p-4",style:{backgroundColor:"#121212",color:"#ffffff"},children:(0,i.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,i.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)(v.A,{onClick:y,variant:"contained",startIcon:(0,i.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),sx:{backgroundColor:"#333",color:"#fff","&:hover":{backgroundColor:"#444"}},children:"Voltar"}),s&&(0,i.jsxs)("div",{className:"ml-4",children:[(0,i.jsx)("h1",{className:"text-2xl font-bold",children:s.title}),(0,i.jsxs)("p",{className:"text-gray-400",children:[s.files.length," arquivo",1!==s.files.length?"s":""]})]})]}),(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)(v.A,{onClick:()=>{x(e=>"grid"===e?"list":"grid")},variant:"outlined",color:"primary",startIcon:"grid"===u?(0,i.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 10h16M4 14h16M4 18h16"})}):(0,i.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 5a1 1 0 011-1h4a1 1 0 011 1v4a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM4 13a1 1 0 011-1h4a1 1 0 011 1v4a1 1 0 01-1 1H5a1 1 0 01-1-1v-4zM14 5a1 1 0 011-1h4a1 1 0 011 1v4a1 1 0 01-1 1h-4a1 1 0 01-1-1V5zM14 13a1 1 0 011-1h4a1 1 0 011 1v4a1 1 0 01-1 1h-4a1 1 0 01-1-1v-4z"})}),children:"grid"===u?"Lista":"Grade"}),(0,i.jsx)(v.A,{onClick:()=>{b(e=>"asc"===e?"desc":"asc")},variant:"outlined",color:"secondary",startIcon:"asc"===g?(0,i.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4h13M3 8h9M3 12h5m0 0v8m0-8h2"})}):(0,i.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4h13M3 8h9M3 12h5m0 0v-8m0 8h2"})}),children:"asc"===g?"Z-A":"A-Z"})]})]}),l?(0,i.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,i.jsx)(f.A,{sx:{color:"#ffffff"}})}):s?(0,i.jsx)(h,{album:{...s,files:N},viewMode:u}):(0,i.jsxs)("div",{className:"text-center text-white",children:[(0,i.jsx)("h1",{className:"text-2xl font-bold",children:"\xc1lbum n\xe3o encontrado"}),(0,i.jsx)("p",{className:"mt-2",children:"O \xe1lbum que voc\xea est\xe1 procurando n\xe3o existe ou foi removido."})]})]})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[857,657,553,441,684,358],()=>t(3387)),_N_E=e.O()}]);