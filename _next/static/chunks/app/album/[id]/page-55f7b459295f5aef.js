(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[880],{669:(e,i,t)=>{"use strict";t.d(i,{K:()=>r});var s=t(3464),a=t(9641).Buffer;class r{getAuthUrl(e){let i=a.from(this.apiKey+":").toString("base64");return"".concat(this.baseUrl).concat(encodeURIComponent("https://pixeldrain.com/api".concat(e)),"&headers=").concat(encodeURIComponent(JSON.stringify({Authorization:"Basic ".concat(i),Accept:"application/json","Content-Type":"application/json"})))}async makeRequest(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=this.getAuthUrl(e),a={...i,timeout:this.timeout,headers:{Accept:"application/json"}};try{let e=await (0,s.A)(t,a);if(!e.data||!e.data.contents)throw Error("Resposta inv\xe1lida do servidor proxy");let i=JSON.parse(e.data.contents);if(!1===i.success&&"authentication_required"===i.value)throw Error("Erro de autentica\xe7\xe3o: Verifique sua API key");if(!1===i.success)throw Error("Erro da API: ".concat(i.message||"Erro desconhecido"));return i}catch(i){if(this.logError("Erro na requisi\xe7\xe3o para ".concat(e),i),s.A.isAxiosError(i)){var r,o,l;if((null===(r=i.response)||void 0===r?void 0:r.status)===403)throw Error("Acesso negado. Verifique sua API key.");throw Error((null===(l=i.response)||void 0===l?void 0:null===(o=l.data)||void 0===o?void 0:o.message)||i.message)}throw i}}logError(e,i){var t,s,a,r,o;console.error("[PixeldrainService Error] ".concat(e),{errorType:null==i?void 0:null===(t=i.constructor)||void 0===t?void 0:t.name,message:null==i?void 0:i.message,status:null==i?void 0:null===(s=i.response)||void 0===s?void 0:s.status,data:null==i?void 0:null===(a=i.response)||void 0===a?void 0:a.data,url:null==i?void 0:null===(r=i.config)||void 0===r?void 0:r.url,method:null==i?void 0:null===(o=i.config)||void 0===o?void 0:o.method})}async getListDetails(e){try{let i=await this.makeRequest("/list/".concat(e));if(!i||!i.files)throw Error("Dados do \xe1lbum inv\xe1lidos ou vazios");let t=i.files.map(e=>({id:e.id||"",name:e.name||"Arquivo sem nome",size:e.size||0,mime_type:e.mime_type||"",views:e.views||0,downloads:e.downloads||0,date_upload:e.date_upload||new Date().toISOString(),date_last_view:e.date_last_view||new Date().toISOString(),hash_sha256:e.hash_sha256||"",can_edit:e.can_edit||!1,description:e.description||""}));return{...i,files:t,file_count:t.length}}catch(e){throw this.logError("Erro ao buscar detalhes do \xe1lbum",e),e}}async getUserLists(){try{let e=await this.makeRequest("/user/lists");if(!Array.isArray(e))return console.warn("Resposta inv\xe1lida da API (getUserLists):",e),[];return e.map(e=>({id:e.id||"",title:e.title||"\xc1lbum sem t\xedtulo",description:e.description||"",date_created:e.date_created||new Date().toISOString(),files:[],can_edit:e.can_edit||!1,file_count:e.file_count||0}))}catch(e){throw this.logError("Erro ao buscar listas do usu\xe1rio",e),e}}async getFiles(){try{let e=await this.makeRequest("/user/files");if(!Array.isArray(e))return console.warn("Resposta inv\xe1lida da API (getFiles):",e),[];return e.map(e=>({id:e.id||"",name:e.name||"Arquivo sem nome",size:e.size||0,mime_type:e.mime_type||"",views:e.views||0,downloads:e.downloads||0,date_upload:e.date_upload||new Date().toISOString(),date_last_view:e.date_last_view||new Date().toISOString(),hash_sha256:e.hash_sha256||"",can_edit:e.can_edit||!1,description:e.description||""}))}catch(e){throw this.logError("Erro ao buscar arquivos do usu\xe1rio",e),e}}getFileViewUrl(e){return"https://pixeldrain.com/u/".concat(e)}getFileDirectUrl(e){return"https://pixeldrain.com/api/file/".concat(e)}getFileThumbnailUrl(e){return"https://pixeldrain.com/api/file/".concat(e,"/thumbnail")}async createAlbum(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return this.makeRequest("/list",{method:"POST",data:{title:e,description:i,files:[]}})}async addFileToAlbum(e,i){await this.makeRequest("/list/".concat(e,"/file/").concat(i),{method:"POST"})}async removeFileFromAlbum(e,i){await this.makeRequest("/list/".concat(e,"/file/").concat(i),{method:"DELETE"})}async deleteAlbum(e){await this.makeRequest("/list/".concat(e),{method:"DELETE"})}async checkAlbumAvailability(e){console.log("[Diagn\xf3stico] Verificando disponibilidade do \xe1lbum: ".concat(e));try{let i=await s.A.head("".concat(this.baseUrl,"/list/").concat(e),{timeout:this.timeout,validateStatus:e=>200===e||404===e});return console.log("[Diagn\xf3stico] Status da verifica\xe7\xe3o de disponibilidade:",{status:i.status,headers:i.headers}),200===i.status}catch(e){return this.logError("Erro ao verificar disponibilidade do \xe1lbum",e),!1}}constructor(){this.baseUrl="https://api.allorigins.win/get?url=",this.apiKey="b34f7bc6-f084-40ca-aedd-eab6d8aa8a85",this.timeout=15e3}}},3387:(e,i,t)=>{Promise.resolve().then(t.bind(t,4423))},4423:(e,i,t)=>{"use strict";t.d(i,{default:()=>g});var s=t(5155),a=t(2115),r=t(669);let o=e=>{var i,t,r;let{file:o}=e,[l,n]=(0,a.useState)(!0),[c,d]=(0,a.useState)(null),[u,m]=(0,a.useState)(!1),h=null===(i=o.mime_type)||void 0===i?void 0:i.startsWith("image/"),v=null===(t=o.mime_type)||void 0===t?void 0:t.startsWith("video/"),p=null===(r=o.mime_type)||void 0===r?void 0:r.startsWith("audio/"),f="application/pdf"===o.mime_type,g="https://pixeldrain.com/api/file/".concat(o.id),x="".concat(g,"?download"),b="https://pixeldrain.com/api/file/".concat(o.id,"/thumbnail"),w=(e,i)=>{console.error("[FileViewer Error] ".concat(e),{fileId:o.id,fileName:o.name,mimeType:o.mime_type,errorDetails:i instanceof Error?i.message:i})};return((0,a.useEffect)(()=>{n(!0),d(null),m(!1);let e=setTimeout(()=>{n(!1)},1e3);return()=>clearTimeout(e)},[o.id]),l)?(0,s.jsx)("div",{className:"flex justify-center items-center p-8 bg-gray-100 rounded-lg",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):c?(0,s.jsxs)("div",{className:"p-4 bg-red-100 text-red-700 rounded-lg",children:[(0,s.jsxs)("p",{children:["Erro ao carregar o arquivo: ",c]}),(0,s.jsx)("button",{className:"mt-2 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",onClick:()=>window.open(x,"_blank"),children:"Tentar Baixar Diretamente"})]}):(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden",children:[(0,s.jsxs)("div",{className:"p-4 bg-gray-50 border-b",children:[(0,s.jsx)("h2",{className:"text-xl font-bold truncate",children:o.name}),(0,s.jsxs)("div",{className:"flex justify-between text-sm text-gray-500 mt-1",children:[(0,s.jsx)("span",{children:function(e){if(0===e)return"0 Bytes";let i=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,i)).toFixed(2))+" "+["Bytes","KB","MB","GB","TB"][i]}(o.size)}),(0,s.jsxs)("span",{children:[o.views||0," visualiza\xe7\xf5es"]})]})]}),(0,s.jsxs)("div",{className:"p-4",children:[h&&(0,s.jsx)("div",{className:"aspect-w-16 aspect-h-9 bg-black flex justify-center",children:(0,s.jsx)("img",{src:g,alt:o.name,className:"max-h-[600px] object-contain mx-auto",onError:e=>{w("Erro ao carregar imagem",e),d("N\xe3o foi poss\xedvel carregar a imagem.")}})}),v&&(0,s.jsx)("div",{className:"aspect-w-16 aspect-h-9 bg-black",children:(0,s.jsx)("video",{src:g,controls:!0,autoPlay:!0,className:"w-full h-full",onError:e=>{w("Erro ao reproduzir v\xeddeo",e),d("N\xe3o foi poss\xedvel reproduzir o v\xeddeo.")},children:"Seu navegador n\xe3o suporta a reprodu\xe7\xe3o de v\xeddeos."})}),p&&(0,s.jsx)("div",{className:"p-4 bg-gray-100 rounded-lg",children:(0,s.jsx)("audio",{src:g,controls:!0,className:"w-full",onError:e=>{w("Erro ao reproduzir \xe1udio",e),d("N\xe3o foi poss\xedvel reproduzir o \xe1udio.")},children:"Seu navegador n\xe3o suporta a reprodu\xe7\xe3o de \xe1udios."})}),f&&(0,s.jsx)("div",{className:"aspect-w-16 aspect-h-9 bg-gray-100 flex justify-center items-center",children:(0,s.jsx)("iframe",{src:"".concat(g,"#toolbar=0"),className:"w-full h-[600px]",title:o.name,onError:e=>{w("Erro ao carregar PDF",e),d("N\xe3o foi poss\xedvel carregar o PDF.")}})}),!h&&!v&&!p&&!f&&(0,s.jsxs)("div",{className:"p-8 flex flex-col items-center justify-center bg-gray-100 rounded-lg",children:[(0,s.jsx)("img",{src:(()=>{if(u){var e,i,t,s,a,r,l,n,c,d,m,h;let u={image:"/icons/image.svg",video:"/icons/video.svg",audio:"/icons/audio.svg",pdf:"/icons/pdf.svg",document:"/icons/document.svg",spreadsheet:"/icons/spreadsheet.svg",presentation:"/icons/presentation.svg",archive:"/icons/archive.svg",default:"/icons/file.svg"};return(null===(e=o.mime_type)||void 0===e?void 0:e.startsWith("image/"))?u.image:(null===(i=o.mime_type)||void 0===i?void 0:i.startsWith("video/"))?u.video:(null===(t=o.mime_type)||void 0===t?void 0:t.startsWith("audio/"))?u.audio:"application/pdf"===o.mime_type?u.pdf:(null===(s=o.mime_type)||void 0===s?void 0:s.includes("document"))||(null===(a=o.mime_type)||void 0===a?void 0:a.includes("word"))?u.document:(null===(r=o.mime_type)||void 0===r?void 0:r.includes("spreadsheet"))||(null===(l=o.mime_type)||void 0===l?void 0:l.includes("excel"))?u.spreadsheet:(null===(n=o.mime_type)||void 0===n?void 0:n.includes("presentation"))||(null===(c=o.mime_type)||void 0===c?void 0:c.includes("powerpoint"))?u.presentation:(null===(d=o.mime_type)||void 0===d?void 0:d.includes("archive"))||(null===(m=o.mime_type)||void 0===m?void 0:m.includes("zip"))||(null===(h=o.mime_type)||void 0===h?void 0:h.includes("rar"))?u.archive:u.default}return b})(),alt:"Thumbnail",className:"w-32 h-32 object-contain mb-4",onError:e=>{w("Erro ao carregar thumbnail",e),m(!0)}}),(0,s.jsx)("p",{className:"text-center mb-4",children:"Este tipo de arquivo n\xe3o pode ser visualizado diretamente no navegador."}),(0,s.jsx)("button",{className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",onClick:()=>window.open(x,"_blank"),children:"Baixar Arquivo"})]})]}),(0,s.jsxs)("div",{className:"p-4 bg-gray-50 border-t flex justify-between",children:[(0,s.jsx)("button",{className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",onClick:()=>window.open(x,"_blank"),children:"Baixar"}),(0,s.jsxs)("div",{className:"text-sm text-gray-500",children:["Compartilhar:",(0,s.jsx)("button",{className:"ml-2 text-blue-500 hover:underline",onClick:()=>{navigator.clipboard.writeText("https://pixeldrain.com/u/".concat(o.id)),alert("Link copiado para \xe1rea de transfer\xeancia!")},children:"Copiar Link"})]})]})]})};var l=t(3100),n=t(3951),c=t(4256),d=t(3339);function u(e){if(e.startsWith("image/"))return"/icons/image.svg";if(e.startsWith("video/"))return"/icons/video.svg";if(e.startsWith("audio/"))return"/icons/audio.svg";if("application/pdf"===e)return"/icons/pdf.svg";if(e.includes("document")||e.includes("word"))return"/icons/document.svg";else if(e.includes("spreadsheet")||e.includes("excel"))return"/icons/spreadsheet.svg";else if(e.includes("presentation")||e.includes("powerpoint"))return"/icons/presentation.svg";else if(e.includes("archive")||e.includes("zip")||e.includes("rar"))return"/icons/archive.svg";else return"/icons/file.svg"}let m=e=>{let{album:i,viewMode:t="grid"}=e,[r,m]=(0,a.useState)(0);if(!i.files||0===i.files.length)return(0,s.jsx)("div",{className:"p-4 bg-yellow-100 text-yellow-700 rounded-lg mb-4",children:"Este \xe1lbum est\xe1 vazio."});let h=i.files[r];return(0,s.jsxs)("div",{className:"bg-gray-900 rounded-lg shadow-lg overflow-hidden",children:[(0,s.jsxs)("div",{className:"p-4",children:[h&&(0,s.jsx)("div",{className:"mb-4"}),(0,s.jsx)(o,{file:h})]}),i.files.length>0&&(0,s.jsxs)("div",{className:"p-4 bg-gray-800",children:[(0,s.jsxs)(l.A,{variant:"h6",className:"text-white mb-4",children:["Arquivos no \xc1lbum (",i.files.length,")"]}),(0,s.jsx)(n.Ay,{container:!0,spacing:2,className:"list"===t?"flex-col":"",children:i.files.map((e,i)=>{var a;return(0,s.jsx)(n.Ay,{item:!0,xs:12,sm:"list"===t?12:6,md:"list"===t?12:4,lg:"list"===t?12:3,children:(0,s.jsxs)(c.A,{className:"cursor-pointer transition-all duration-200 ".concat(r===i?"ring-2 ring-blue-500":"hover:ring-2 hover:ring-blue-300"," ").concat("list"===t?"flex items-center":""),onClick:()=>m(i),sx:{backgroundColor:"#1a1a1a",height:"100%",flexDirection:"list"===t?"row":"column"},children:[(0,s.jsx)("div",{className:"relative ".concat("list"===t?"w-32 h-24 mr-4 flex-shrink-0":"aspect-w-16 aspect-h-9"),children:(null===(a=e.mime_type)||void 0===a?void 0:a.startsWith("video/"))?(0,s.jsxs)("div",{className:"w-full h-full bg-black flex items-center justify-center",children:[(0,s.jsx)("img",{src:"https://pixeldrain.com/api/file/".concat(e.id,"/thumbnail"),alt:e.name,className:"w-full h-full object-cover",onError:i=>{i.currentTarget.src=u(e.mime_type||"")}}),(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,s.jsx)("svg",{className:"w-12 h-12 text-white opacity-80",fill:"currentColor",viewBox:"0 0 20 20",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z",clipRule:"evenodd"})})})]}):(0,s.jsx)("img",{src:"https://pixeldrain.com/api/file/".concat(e.id,"/thumbnail"),alt:e.name,className:"w-full h-full object-cover",onError:i=>{i.currentTarget.src=u(e.mime_type||"")}})}),(0,s.jsxs)(d.A,{sx:{color:"#fff",flex:1,display:"flex",flexDirection:"column",justifyContent:"center"},children:[(0,s.jsx)(l.A,{variant:"subtitle1",component:"h3",className:"font-medium ".concat("list"===t?"text-base":"truncate"),children:e.name}),(0,s.jsx)(l.A,{variant:"body2",className:"text-gray-400 ".concat("list"===t?"text-sm":""),children:function(e){if(0===e)return"0 Bytes";let i=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,i)).toFixed(2))+" "+["Bytes","KB","MB","GB","TB"][i]}(e.size)}),(0,s.jsxs)(l.A,{variant:"caption",className:"text-gray-500 ".concat("list"===t?"text-xs":""),children:[e.views," visualiza\xe7\xf5es"]})]})]})},e.id)})})]})]})};var h=t(3088),v=t(5857),p=t(9915),f=t(5695);function g(e){let{params:i}=e,[t,o]=(0,a.useState)(null),[l,n]=(0,a.useState)(!0),[c,d]=(0,a.useState)(null),[u,g]=(0,a.useState)("grid"),[x,b]=(0,a.useState)("asc"),w=(0,f.useRouter)(),j=new r.K,y=(e,i)=>{console.log("[AlbumPageClient Diagn\xf3stico] ".concat(e),i||"")},N=(e,i)=>{console.error("[AlbumPageClient Erro] ".concat(e),i||"")};(0,a.useEffect)(()=>{(async()=>{try{var e;let t=null===(e=i.id)||void 0===e?void 0:e.trim();if(y("Iniciando carregamento do \xe1lbum",{albumId:t}),!t||""===t||"default-album"===t||"undefined"===t)throw Error('ID de \xe1lbum inv\xe1lido: "'.concat(t,'"'));if(!await j.checkAlbumAvailability(t))throw Error("\xc1lbum ".concat(t," n\xe3o est\xe1 dispon\xedvel"));y("Carregando detalhes do \xe1lbum");let s=await j.getListDetails(t);y("Dados do \xe1lbum carregados",{albumId:s.id,title:s.title,fileCount:s.files.length}),o(s)}catch(t){N("Erro ao carregar \xe1lbum",t);let e=t instanceof Error?t.message:"Erro desconhecido ao carregar \xe1lbum";d(e),o({id:i.id||"album-erro",title:"\xc1lbum n\xe3o encontrado",description:e,date_created:new Date().toISOString(),files:[],can_edit:!1,file_count:0})}finally{n(!1),y("Carregamento do \xe1lbum finalizado")}})()},[i.id]);let _=()=>{w.push("/")},k=(null==t?void 0:t.files)?[...t.files].sort((e,i)=>{let t=e.name.localeCompare(i.name);return"asc"===x?t:-t}):[];return"default-album"===i.id||c?(0,s.jsx)("main",{className:"min-h-screen p-4",style:{backgroundColor:"#121212",color:"#ffffff"},children:(0,s.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,s.jsx)(h.A,{severity:"warning",sx:{mb:2,backgroundColor:"#ffa50033",color:"#ffffff"},children:c||"Este \xe1lbum n\xe3o est\xe1 dispon\xedvel no momento."}),(0,s.jsx)(v.A,{variant:"contained",onClick:_,sx:{backgroundColor:"#333",color:"#fff","&:hover":{backgroundColor:"#444"}},children:"Voltar para o In\xedcio"})]})}):(0,s.jsx)("main",{className:"min-h-screen p-4",style:{backgroundColor:"#121212",color:"#ffffff"},children:(0,s.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,s.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(v.A,{onClick:_,variant:"contained",startIcon:(0,s.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),sx:{backgroundColor:"#333",color:"#fff","&:hover":{backgroundColor:"#444"}},children:"Voltar"}),t&&(0,s.jsxs)("div",{className:"ml-4",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold",children:t.title}),(0,s.jsxs)("p",{className:"text-gray-400",children:[t.files.length," arquivo",1!==t.files.length?"s":""]})]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(v.A,{onClick:()=>{g(e=>"grid"===e?"list":"grid")},variant:"outlined",color:"primary",startIcon:"grid"===u?(0,s.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 10h16M4 14h16M4 18h16"})}):(0,s.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 5a1 1 0 011-1h4a1 1 0 011 1v4a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM4 13a1 1 0 011-1h4a1 1 0 011 1v4a1 1 0 01-1 1H5a1 1 0 01-1-1v-4zM14 5a1 1 0 011-1h4a1 1 0 011 1v4a1 1 0 01-1 1h-4a1 1 0 01-1-1V5zM14 13a1 1 0 011-1h4a1 1 0 011 1v4a1 1 0 01-1 1h-4a1 1 0 01-1-1v-4z"})}),children:"grid"===u?"Lista":"Grade"}),(0,s.jsx)(v.A,{onClick:()=>{b(e=>"asc"===e?"desc":"asc")},variant:"outlined",color:"secondary",startIcon:"asc"===x?(0,s.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4h13M3 8h9M3 12h5m0 0v8m0-8h2"})}):(0,s.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4h13M3 8h9M3 12h5m0 0v-8m0 8h2"})}),children:"asc"===x?"Z-A":"A-Z"})]})]}),l?(0,s.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,s.jsx)(p.A,{sx:{color:"#ffffff"}})}):t?(0,s.jsx)(m,{album:{...t,files:k},viewMode:u}):(0,s.jsxs)("div",{className:"text-center text-white",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold",children:"\xc1lbum n\xe3o encontrado"}),(0,s.jsx)("p",{className:"mt-2",children:"O \xe1lbum que voc\xea est\xe1 procurando n\xe3o existe ou foi removido."})]})]})})}}},e=>{var i=i=>e(e.s=i);e.O(0,[295,657,951,441,684,358],()=>i(3387)),_N_E=e.O()}]);